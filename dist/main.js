!function(t){var e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s={FPS:30,SCREEN_WIDTH:640,SCREEN_HEIGHT:480,SHIP_SIZE:30,TURN_SPEED:360,SHIP_THRUST:5,FRICTION:.7,ROIDS_NUM:3,ROIDS_JAG:.25,ROIDS_SIZE:100,ROIDS_SPD:50,ROIDS_VERT:12,SHOW_BOUNDING:!1,SHOW_CENTER_DOT:!1,SHIP_EXPLODE_DUR:.3,SHIP_INV_DUR:3,SHIP_BLINK_DUR:.1,LASER_MAX:10,LASER_SPD:500,LASER_DIST:.6,LASER_EXPLODE_DUR:.1,TEXT_FADE_TIME:2.5,TEXT_SIZE:40,GAME_LIVES:3,ROIDS_PTS_LG:20,ROIDS_PTS_MD:50,ROIDS_PTS_SM:100,SAVE_KEY_SCORE:"highscore",SOUND_ON:!0,MUSIC_ON:!0,SOUND_DIR:"sounds"};var a=class{constructor(t){this.ctx=t}drawIsoscelesTriangle(t,e,i,s,a,o,n){this.ctx.beginPath(),this.ctx.moveTo(t+4/3*i*Math.cos(s),e-4/3*i*Math.sin(s)),this.ctx.lineTo(t-i*(2/3*Math.cos(s)+Math.sin(s)),e+i*(2/3*Math.sin(s)-Math.cos(s))),this.ctx.lineTo(t-i*(2/3*Math.cos(s)-Math.sin(s)),e+i*(2/3*Math.sin(s)+Math.cos(s))),this.ctx.closePath(),a&&o&&(this.ctx.strokeStyle=a,this.ctx.lineWidth=o,this.ctx.stroke()),n&&(this.ctx.fillColor=n,this.ctx.fill())}},o={toRadians:t=>t/180*Math.PI};var n=class{constructor(t){this.xPosition=t.x,this.yPosition=t.y,this.shipSize=t.shipSize,this.radius=this.shipSize/2,this.angle=t.angle,this.rotationSpeed=t.rotationSpeed,this.thrusting=!1,this.thrust={x:0,y:0},this.explodeTime=0,this.blinkTime=Math.ceil(s.SHIP_BLINK_DUR*s.FPS),this.blinkNum=Math.ceil(s.SHIP_INV_DUR/s.SHIP_BLINK_DUR),this.canShoot=!0,this.lasers=[],this.dead=!1,this.color="white"}update(){this.angle+=this.rotationSpeed}draw(t){t.drawIsoscelesTriangle(this.xPosition,this.yPosition,this.radius,this.angle,this.color,.05*this.shipSize)}};!function(){const t=function(){let t=document.createElement("canvas");return t.setAttribute("id","gameCanvas"),t.setAttribute("width",s.SCREEN_WIDTH),t.setAttribute("height",s.SCREEN_HEIGHT),t}();document.body.appendChild(t);const e=t.getContext("2d"),i=new a(e);let r,h,l,c,S,d,u,I;const _=new N("laser.m4a",5,.5),P=new N("explode.m4a"),m=new N("hit.m4a",5),f=new N("thrust.m4a"),M=new function(t,e){this.soundLow=new Audio(`${s.SOUND_DIR}/${t}`),this.soundHigh=new Audio(`${s.SOUND_DIR}/${e}`),this.low=!0,this.tempo=1,this.beatTime=0,this.play=function(){s.MUSIC_ON&&(this.low?this.soundLow.play():this.soundHigh.play(),this.low=!this.low)},this.tick=function(){0==this.beatTime?(this.play(),this.beatTime=Math.ceil(this.tempo*s.FPS)):this.beatTime--},this.setTempo=function(t){this.tempo=1-.75*(1-t)}}("music-low.m4a","music-high.m4a");let E,p;function T(){r=0,u=0,d=s.GAME_LIVES,l=D();var t=localStorage.getItem(s.SAVE_KEY_SCORE);I=null==t?0:parseInt(t,10),R()}function R(){c=`Level ${r+1}`,S=1,h=[],function(){let e,i;h=[];for(var a=0;a<s.ROIDS_NUM+r;a++){do{e=Math.floor(Math.random()*t.width),i=Math.floor(Math.random()*t.height)}while(w(l.xPosition,l.yPosition,e,i)<2*s.ROIDS_SIZE+l.radius);h.push(g(e,i,Math.ceil(s.ROIDS_SIZE/2)))}p=7*h.length,E=p}()}function D(){return new n({x:t.width/2,y:t.height/2,shipSize:s.SHIP_SIZE,angle:o.toRadians(90),rotationSpeed:0})}function g(t,e,i){for(var a=1+.1*r,o={x:t,y:e,xv:Math.random()*s.ROIDS_SPD*a/s.FPS*(Math.random()<.5?1:-1),yv:Math.random()*s.ROIDS_SPD*a/s.FPS*(Math.random()<.5?1:-1),r:i,a:Math.random()*Math.PI*2,vert:Math.floor(Math.random()*(s.ROIDS_VERT+1)+s.ROIDS_VERT/2),offs:[]},n=0;n<o.vert;n++)o.offs.push(Math.random()*s.ROIDS_JAG*2+1-s.ROIDS_JAG);return o}function O(t){var e=h[t].x,i=h[t].y,a=h[t].r;a==Math.ceil(s.ROIDS_SIZE/2)?(u+=s.ROIDS_PTS_LG,h.push(g(e,i,Math.ceil(s.ROIDS_SIZE/4))),h.push(g(e,i,Math.ceil(s.ROIDS_SIZE/4)))):a==Math.ceil(s.ROIDS_SIZE/4)?(u+=s.ROIDS_PTS_MD,h.push(g(e,i,Math.ceil(s.ROIDS_SIZE/8))),h.push(g(e,i,Math.ceil(s.ROIDS_SIZE/8)))):u+=s.ROIDS_PTS_SM,u>I&&(I=u,localStorage.setItem(s.SAVE_KEY_SCORE,I)),h.splice(t,1),m.play(),E--,M.setTempo(0==E?1:E/p),0==h.length&&(r++,R())}function w(t,e,i,s){return Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2))}function N(t,e=1,i=1){this.streamNum=0,this.streams=[];for(let a=0;this.streams.length<e;a++)this.streams.push(new Audio(`${s.SOUND_DIR}/${t}`)),this.streams[a].volume=i;this.play=function(){s.SOUND_ON&&(this.streamNum=(this.streamNum+1)%e,this.streams[this.streamNum].play())},this.stop=function(){this.streams[this.streamNum].pause(),this.streams[this.streamNum].currentTime=0}}function b(t,e,a,o="white"){i.ctx.strokeStyle=o,i.ctx.lineWidth=.05*s.SHIP_SIZE,i.ctx.beginPath(),i.ctx.moveTo(t+4/3*l.radius*Math.cos(a),e-4/3*l.radius*Math.sin(a)),i.ctx.lineTo(t-l.radius*(2/3*Math.cos(a)+Math.sin(a)),e+l.radius*(2/3*Math.sin(a)-Math.cos(a))),i.ctx.lineTo(t-l.radius*(2/3*Math.cos(a)-Math.sin(a)),e+l.radius*(2/3*Math.sin(a)+Math.cos(a))),i.ctx.closePath(),i.ctx.stroke()}function v(t){i.ctx.strokeStyle="slategrey",i.ctx.lineWidth=.05*s.SHIP_SIZE;const e=t.x,a=t.y,o=t.r,n=t.a,r=t.vert,h=t.offs;i.ctx.beginPath(),i.ctx.moveTo(e+o*h[0]*Math.cos(n),a+o*h[0]*Math.sin(n));for(var l=1;l<r;l++)i.ctx.lineTo(e+o*h[l]*Math.cos(n+l*Math.PI*2/r),a+o*h[l]*Math.sin(n+l*Math.PI*2/r));i.ctx.closePath(),i.ctx.stroke(),s.SHOW_BOUNDING&&H(e,a,o,"lime","")}function H(t,e,s,a,o){a&&(i.ctx.strokeStyle=a),o&&(i.ctx.fillStyle=o),i.ctx.beginPath(),i.ctx.arc(t,e,s,0,2*Math.PI,!1),a&&i.ctx.stroke(),o&&i.ctx.fill()}function k(t){0==t.explodeTime?H(t.x,t.y,s.SHIP_SIZE/15,"","salmon"):(H(t.x,t.y,.75*l.radius,"","orangered"),H(t.x,t.y,.5*l.radius,"","salmon"),H(t.x,t.y,.25*l.radius,"","pink"))}T(),document.addEventListener("keydown",function(t){if(!l.dead)switch(t.keyCode){case 37:l.rotationSpeed=o.toRadians(s.TURN_SPEED)/s.FPS;break;case 38:l.thrusting=!0;break;case 39:l.rotationSpeed=o.toRadians(-s.TURN_SPEED)/s.FPS;break;case 32:l.canShoot&&l.lasers.length<s.LASER_MAX&&(l.lasers.push({x:l.xPosition+4/3*l.radius*Math.cos(l.angle),y:l.yPosition-4/3*l.radius*Math.sin(l.angle),xv:s.LASER_SPD*Math.cos(l.angle)/s.FPS,yv:-s.LASER_SPD*Math.sin(l.angle)/s.FPS,dist:0,explodeTime:0}),_.play()),l.canShoot=!1}}),document.addEventListener("keyup",function(t){if(!l.dead)switch(t.keyCode){case 37:l.rotationSpeed=0;break;case 38:l.thrusting=!1;break;case 39:l.rotationSpeed=0;break;case 32:l.canShoot=!0}}),setInterval(function(){var e,a,n,r,_,m,E=l.blinkNum%2==0,p=l.explodeTime>0;M.tick(),i.ctx.fillStyle="black",i.ctx.fillRect(0,0,t.width,t.height),l.thrusting&&!l.dead?(f.play(),l.thrust.x+=s.SHIP_THRUST*Math.cos(l.angle)/s.FPS,l.thrust.y-=s.SHIP_THRUST*Math.sin(l.angle)/s.FPS):(f.stop(),l.thrust.x-=s.FRICTION*l.thrust.x/s.FPS,l.thrust.y-=s.FRICTION*l.thrust.y/s.FPS),p?(H(l.xPosition,l.yPosition,1.7*l.radius,"","darkred"),H(l.xPosition,l.yPosition,1.4*l.radius,"","red"),H(l.xPosition,l.yPosition,1.1*l.radius,"","orange"),H(l.xPosition,l.yPosition,.8*l.radius,"","yellow"),H(l.xPosition,l.yPosition,.5*l.radius,"","white")):l.dead||(E&&(l.draw(i),l.thrusting&&function(t,e,a){i.ctx.strokeStyle="pink",i.ctx.fillStyle="blue",i.ctx.lineWidth=.1*s.SHIP_SIZE,i.ctx.beginPath(),i.ctx.moveTo(t-l.radius*(2/3*Math.cos(a)+.5*Math.sin(a)),e+l.radius*(2/3*Math.sin(a)-.5*Math.cos(a))),i.ctx.lineTo(t-6*l.radius/3*Math.cos(a),e+6*l.radius/3*Math.sin(a)),i.ctx.lineTo(t-l.radius*(2/3*Math.cos(a)-.5*Math.sin(a)),e+l.radius*(2/3*Math.sin(a)+.5*Math.cos(a))),i.ctx.closePath(),i.ctx.fill(),i.ctx.stroke()}(l.xPosition,l.yPosition,l.angle),s.SHOW_CENTER_DOT&&(i.ctx.fillStyle="red",i.ctx.fillRect(x-1,y-1,2,2)),s.SHOW_BOUNDING&&H(x,y,l.radius,"lime","")),l.blinkNum>0&&(l.blinkTime--,0==l.blinkTime&&(l.blinkTime=Math.ceil(s.SHIP_BLINK_DUR*s.FPS),l.blinkNum--)));for(let t=0;t<l.lasers.length;t++)k(l.lasers[t]);for(var R=0;R<h.length;R++)v(h[R]);S>0?(i.ctx.textAlign="center",i.ctx.textBaseline="middle",i.ctx.fillStyle=`rgba(255,255,255,${S})`,i.ctx.font=`small-caps ${s.TEXT_SIZE}px mono`,i.ctx.fillText(c,t.width/2,.75*t.height),S-=1/s.TEXT_FADE_TIME/s.FPS):l.dead&&T();for(let t=0;t<d;t++)e=p&&t==d-1?"red":"white",b(s.SHIP_SIZE+t*s.SHIP_SIZE*1.2,s.SHIP_SIZE,o.toRadians(90),e);i.ctx.textAlign="right",i.ctx.textBaseline="middle",i.ctx.fillStyle="white",i.ctx.font=`${s.TEXT_SIZE}px mono`,i.ctx.fillText(u,t.width-s.SHIP_SIZE/2,s.SHIP_SIZE),i.ctx.textAlign="right",i.ctx.textBaseline="middle",i.ctx.fillStyle="slategrey",i.ctx.font=`${.5*s.TEXT_SIZE}px mono`,i.ctx.fillText(`HI SCORE: ${I}`,t.width-s.SHIP_SIZE/2,2*s.SHIP_SIZE);for(let t=h.length-1;t>=0;t--){a=h[t].x,n=h[t].y,r=h[t].r;for(let e=l.lasers.length-1;e>=0;e--)if(_=l.lasers[e].x,m=l.lasers[e].y,0==l.lasers[e].explodeTime&&w(a,n,_,m)<r){O(t),l.lasers[e].explodeTime=Math.ceil(s.LASER_EXPLODE_DUR*s.FPS);break}}if(p)l.explodeTime--,l.explodeTime<=0&&(0==--d?(l.dead=!0,c="Game Over",S=1):l=D());else{if(0==l.blinkNum&&!l.dead)for(let t=0;t<h.length;t++)if(w(l.xPosition,l.yPosition,h[t].x,h[t].y)<l.radius+h[t].r){l.explodeTime=Math.ceil(s.SHIP_EXPLODE_DUR*s.FPS),P.play(),O(t);break}l.update(),l.xPosition+=l.thrust.x,l.yPosition+=l.thrust.y}l.xPosition<0-l.radius?l.xPosition=t.width+l.radius:l.xPosition>t.width+l.radius&&(l.xPosition=0-l.radius),l.yPosition<0-l.radius?l.yPosition=t.height+l.radius:l.yPosition>t.height+l.radius&&(l.yPosition=0-l.radius);for(let e=l.lasers.length-1;e>=0;e--)l.lasers[e].explodeTime>0?(l.lasers[e].explodeTime--,0==l.lasers[e].explodeTime&&l.lasers.splice(e,1)):l.lasers[e].dist>s.LASER_DIST*t.width?l.lasers.splice(e,1):(l.lasers[e].x+=l.lasers[e].xv,l.lasers[e].y+=l.lasers[e].yv,l.lasers[e].dist+=Math.sqrt(Math.pow(l.lasers[e].xv,2)+Math.pow(l.lasers[e].yv,2)),l.lasers[e].x<0?l.lasers[e].x=t.width:l.lasers[e].x>t.width&&(l.lasers[e].x=0),l.lasers[e].y<0?l.lasers[e].y=t.height:l.lasers[e].y>t.height&&(l.lasers[e].y=0));for(let e=0;e<h.length;e++)h[e].x+=h[e].xv,h[e].y+=h[e].yv,h[e].x<0-h[e].r?h[e].x=t.width+h[e].r:h[e].x>t.width+h[e].r&&(h[e].x=0-h[e].r),h[e].y<0-h[e].r?h[e].y=t.height+h[e].r:h[e].y>t.height+h[e].r&&(h[e].y=0-h[e].r)},1e3/s.FPS)}()}]);